# Supabase æ¶æ§‹æ±ºç­–è¨˜éŒ„

**ç‹€æ…‹**: âœ… å·²å®Œæˆï¼ˆTask 3ï¼‰
**æœ€å¾Œæ›´æ–°**: 2025-11-24

---

## ğŸ¯ ç›®çš„

æœ¬æ–‡æª”è¨˜éŒ„ Flourish å°ˆæ¡ˆä¸­æ‰€æœ‰é‡è¦çš„æ¶æ§‹æ±ºç­–ï¼ŒåŒ…æ‹¬é¸æ“‡ Supabase-first æ¶æ§‹çš„åŸå› ã€å¯¦æ–½éç¨‹ã€ä»¥åŠç›¸é—œçš„æŠ€è¡“æ±ºç­–ã€‚

æ‰€æœ‰æ¶æ§‹æ±ºç­–éµå¾ª **Architecture Decision Record (ADR)** æ ¼å¼ï¼Œç¢ºä¿æ±ºç­–å¯è¿½æº¯ã€æœ‰ç†æœ‰æ“šã€‚

---

## ğŸ“‹ æ¶æ§‹æ±ºç­–ç´¢å¼•

### å·²æ¡ç´çš„æ±ºç­–

| ADR                                                       | æ¨™é¡Œ                                          | æ—¥æœŸ       | ç‹€æ…‹      | å½±éŸ¿ç¯„åœ   |
| --------------------------------------------------------- | --------------------------------------------- | ---------- | --------- | ---------- |
| [001](../../decisions/001-architecture-simplification.md) | æ¶æ§‹ç°¡åŒ– - å¾ NestJS é·ç§»åˆ° Supabase          | 2025-11-07 | âœ… å·²æ¡ç´ | æ•´é«”æ¶æ§‹   |
| [002](../../decisions/002-imperative-migrations.md)       | ä½¿ç”¨ Imperative Migrations ç®¡ç†è³‡æ–™åº« Schema  | 2025-11-13 | âœ… å·²æ¡ç´ | è³‡æ–™åº«ç®¡ç† |
| [003](../../decisions/design-system-configuration.md)     | Design System é…ç½®ï¼ˆshadcn/ui + Tailwind v4ï¼‰ | 2025-11-05 | âœ… å·²æ¡ç´ | å‰ç«¯è¨­è¨ˆ   |

### æ±ºç­–çµ±è¨ˆ

- **ç¸½æ±ºç­–æ•¸**: 3 å€‹
- **å·²æ¡ç´**: 3 å€‹
- **å·²å»¢æ£„**: 0 å€‹
- **å¯©æŸ¥ä¸­**: 0 å€‹

---

## ğŸ“Š æ±ºç­–æ™‚é–“è»¸

### 2025-11 - æ¶æ§‹åŸºç¤æ±ºç­–

```mermaid
gitGraph
    commit id: "Sprint 7 é–‹å§‹"
    commit id: "11-05: ADR 003 Design System"
    branch sprint-8
    checkout sprint-8
    commit id: "11-06: Sprint 8 - éƒ¨ç½²è©•ä¼°"
    commit id: "11-07: Render Staging æ¸¬è©¦"
    commit id: "11-07: Supabase vs NestJS åˆ†æ"
    commit id: "11-07: âœ… ADR 001 æ±ºå®šæ¡ç”¨ Supabase" type: HIGHLIGHT
    checkout main
    merge sprint-8
    branch sprint-9
    checkout sprint-9
    commit id: "11-13: Sprint 9 - é·ç§»é–‹å§‹"
    commit id: "11-13: ADR 002 Imperative Migrations"
    commit id: "11-15~21: å¯¦ä½œé·ç§»"
    commit id: "11-21: âœ… Sprint 9 å®Œæˆ" type: HIGHLIGHT
    checkout main
    merge sprint-9
    commit id: "Sprint 10-11: æ–‡æª”èˆ‡å·¥å…·"
```

**è¦–è¦ºåŒ–æ™‚é–“è»¸èªªæ˜**ï¼š

- ğŸ”µ è—é»ï¼šä¸€èˆ¬ä»»å‹™èˆ‡æ±ºç­–
- ğŸŸ¢ ç¶ é»ï¼šé‡å¤§é‡Œç¨‹ç¢‘

### é—œéµé‡Œç¨‹ç¢‘

1. **Sprint 7 (2025-11-05)**: å»ºç«‹è¨­è¨ˆç³»çµ±åŸºç¤ï¼ˆADR 003ï¼‰
2. **Sprint 8 (2025-11-06~07)**: å®Œæ•´è©•ä¼°ä¸¦æ±ºå®šæ¶æ§‹æ–¹å‘ï¼ˆADR 001ï¼‰
3. **Sprint 9 (2025-11-13~21)**: å¯¦ç¾ Supabase æ¶æ§‹é·ç§»ï¼ˆADR 002ï¼‰
4. **Sprint 10-11**: æ–‡æª”èˆ‡å·¥å…·å®Œå–„

---

## âœ… ADR 001: ç‚ºä½•é¸æ“‡ Supabaseï¼Ÿ

**æ—¥æœŸ**: 2025-11-07
**æ±ºç­–è€…**: Henry Lee
**å®Œæ•´æ–‡æª”**: [ADR 001](../../decisions/001-architecture-simplification.md)

### æ±ºç­–æ‘˜è¦

å¾ **NestJS + Render** æ¶æ§‹é·ç§»åˆ° **ç´” Supabase** æ¶æ§‹ã€‚

**åŸå§‹æ¶æ§‹**:

```
Frontend (Flow/Apex) â†’ NestJS API â†’ Supabase Database
         â†“                â†“
     Vercel           Render ($7/æœˆ)
```

**æ–°æ¶æ§‹**:

```
Frontend (Flow/Apex) â†’ Supabase (Database + Auth + REST API)
         â†“
     Vercel ($0)
```

### é¸æ“‡åŸå› 

#### 1. æˆæœ¬æ•ˆç›Š ğŸ’°

**Supabase Free Tier å®Œå…¨è¶³å¤  Release 0-1**:

| é …ç›®       | Supabase Free | NestJS + Render | ç¯€çœ     |
| ---------- | ------------- | --------------- | -------- |
| æœˆè²»ç”¨     | **$0**        | $7+             | **100%** |
| è³‡æ–™åº«å„²å­˜ | 500MB         | N/A             | -        |
| æª”æ¡ˆå„²å­˜   | 1GB           | N/A             | -        |
| æœˆæ´»èºç”¨æˆ¶ | 50,000        | N/A             | -        |
| API è«‹æ±‚   | Unlimited     | Unlimited       | -        |
| èªè­‰       | å…§å»º          | éœ€è‡ªè¡Œå¯¦ä½œ      | -        |

**å¯¦éš›å½±éŸ¿**:

- Release 0-1 é æœŸç”¨æˆ¶ < 100
- è³‡æ–™é‡é ä¼° < 50MB
- å®Œå…¨ç¬¦åˆå…è²»å±¤ç´šé™åˆ¶
- **å¹´çœ $84+**

#### 2. é–‹ç™¼æ•ˆç‡ âš¡

**CRUD åŠŸèƒ½é–‹ç™¼æ™‚é–“æ¯”è¼ƒ**:

| æ­¥é©Ÿ                | Supabase                  | NestJS                        | ç¯€çœæ™‚é–“   |
| ------------------- | ------------------------- | ----------------------------- | ---------- |
| **Schema å®šç¾©**     | 30 min (SQL)              | 15 min (Prisma)               | -          |
| **RLS/Auth è¨­ç½®**   | Schema å…§å®Œæˆ             | 20 min (Guards + Middleware)  | **20 min** |
| **DTO å®šç¾©**        | è‡ªå‹•ç”Ÿæˆ TypeScript types | 20 min (æ‰‹å¯« class-validator) | **20 min** |
| **Service å¯¦ä½œ**    | N/A (ç›´æ¥ä½¿ç”¨ REST API)   | 30 min (æ‰‹å¯« CRUD)            | **30 min** |
| **Controller å¯¦ä½œ** | N/A                       | 30 min (è·¯ç”± + é©—è­‰)          | **30 min** |
| **Module è¨»å†Š**     | N/A                       | 10 min (providers, exports)   | **10 min** |
| **æ¸¬è©¦æ’°å¯«**        | N/A (å‰ç«¯æ•´åˆæ¸¬è©¦)        | 60 min (å–®å…ƒ + æ•´åˆ)          | **60 min** |
| **éƒ¨ç½²**            | å·²éƒ¨ç½²                    | éœ€é¡å¤–é…ç½®                    | **10 min** |
| **ç¸½è¨ˆ**            | **45 åˆ†é˜**               | **3 å°æ™‚**                    | **75%**    |

**å¯¦éš›æ¡ˆä¾‹ï¼ˆä¾†è‡ª Sprint 9 Task 3ï¼‰**:

```typescript
// âœ… Supabase æ–¹å¼ï¼ˆ5 åˆ†é˜ï¼‰
export async function getTransactions(userId: string) {
  const supabase = await createServerClient();
  const { data, error } = await supabase
    .from('transactions')
    .select('*, category:categories(*), card:cards(*)')
    .eq('user_id', userId)
    .order('date', { ascending: false });

  if (error) throw new Error(`Failed to fetch: ${error.message}`);
  return data;
}

// âŒ NestJS æ–¹å¼éœ€è¦ï¼ˆ30+ åˆ†é˜ï¼‰:
// 1. DTO (create, update, response)
// 2. Service (CRUD + é—œè¯æŸ¥è©¢)
// 3. Controller (è·¯ç”± + Guards)
// 4. Module (è¨»å†Š)
// 5. æ¸¬è©¦ï¼ˆå–®å…ƒ + æ•´åˆï¼‰
```

#### 3. ç¶­è­·ç°¡åŒ– ğŸ› ï¸

**NestJS æ–¹æ¡ˆéœ€è¦ç¶­è­·**:

- Render Staging ç’°å¢ƒé…ç½®
- Render Production ç’°å¢ƒé…ç½®
- ç’°å¢ƒè®Šæ•¸åŒæ­¥ï¼ˆ6+ è®Šæ•¸ Ã— 2 ç’°å¢ƒï¼‰
- Keep-Alive ç›£æ§ï¼ˆUptimeRobot æˆ– Cronï¼‰
- API ç‰ˆæœ¬ç®¡ç†èˆ‡éƒ¨ç½²
- ä¼ºæœå™¨å¥åº·æª¢æŸ¥
- CORS é…ç½®ç¶­è­·
- æ—¥èªŒç›£æ§èˆ‡é™¤éŒ¯

**Supabase æ–¹æ¡ˆéœ€è¦ç¶­è­·**:

- Supabase å°ˆæ¡ˆè¨­å®šï¼ˆä¸€æ¬¡æ€§ï¼‰
- Row Level Security policiesï¼ˆéš¨åŠŸèƒ½æ›´æ–°ï¼‰
- å‰ç«¯ç’°å¢ƒè®Šæ•¸ï¼ˆ2 å€‹è®Šæ•¸ï¼‰
- Database é·ç§»ï¼ˆSQL æª”æ¡ˆï¼‰

**å¯¦éš›å½±éŸ¿**:

- **æ¸›å°‘ç´„ 70% ç¶­è­·å·¥ä½œé‡**
- ç„¡éœ€ç®¡ç†ä¼ºæœå™¨
- ç„¡éœ€è¨­å®š CI/CD pipelineï¼ˆè³‡æ–™åº«å±¤ï¼‰
- Supabase è‡ªå‹•è™•ç†å‚™ä»½ã€æ“´å±•ã€ç›£æ§

#### 4. åŠŸèƒ½å®Œæ•´æ€§ ğŸ“¦

**Supabase æä¾›å®Œæ•´çš„ Backend-as-a-Service**:

| åŠŸèƒ½                   | èªªæ˜                         | Flourish ä½¿ç”¨ç‹€æ…‹ |
| ---------------------- | ---------------------------- | ----------------- |
| **PostgreSQL**         | å®Œæ•´çš„é—œè¯å¼è³‡æ–™åº«           | âœ… 7 å€‹æ ¸å¿ƒè³‡æ–™è¡¨ |
| **REST API**           | è‡ªå‹•ç”Ÿæˆçš„ RESTful endpoints | âœ… æ‰€æœ‰ CRUD æ“ä½œ |
| **Row Level Security** | è³‡æ–™åº«å±¤ç´šæ¬Šé™æ§åˆ¶           | âœ… ä½¿ç”¨è€…è³‡æ–™éš”é›¢ |
| **Supabase Auth**      | å…§å»ºèªè­‰ç³»çµ±                 | ğŸ”œ Release 1      |
| **Realtime**           | WebSocket è¨‚é–±               | ğŸ“‹ æœªä¾†è€ƒæ…®       |
| **Storage**            | S3-compatible æª”æ¡ˆå„²å­˜       | ğŸ“‹ æœªä¾†è€ƒæ…®       |
| **Edge Functions**     | Serverless functions         | ğŸ“‹ è¤‡é›œé‚è¼¯æ™‚ä½¿ç”¨ |
| **Database Functions** | PostgreSQL stored procedures | âœ… æ¥­å‹™é‚è¼¯è¼”åŠ©   |

**å¯¦éš›å„ªå‹¢**:

- ä¸€ç«™å¼è§£æ±ºæ–¹æ¡ˆ
- åŠŸèƒ½ä¹‹é–“ç·Šå¯†æ•´åˆ
- ç„¡éœ€é¡å¤–çš„æœå‹™æ•´åˆæˆæœ¬

#### 5. æŠ€è¡“é©é…æ€§ âœ…

**Flourish æ ¸å¿ƒéœ€æ±‚åˆ†æ**:

```typescript
// Flourish ä¸»è¦åŠŸèƒ½
const flourishFeatures = {
  // âœ… å®Œç¾é©åˆ Supabase
  transactionsCRUD: 'CREATE, READ, UPDATE, DELETE',
  categoriesManagement: 'Simple CRUD',
  cardsManagement: 'Simple CRUD',
  statementsTracking: 'Time-series data',
  statisticsCalculation: 'Database aggregations',
  userAuthentication: 'Built-in Supabase Auth',
  dataVisualization: 'Frontend (Chart.js + React)',

  // âŒ ä¸éœ€è¦ NestJS çš„åŠŸèƒ½
  complexBusinessLogic: false,
  multiStepWorkflows: false,
  heavyBackgroundJobs: false,
  thirdPartyIntegrations: false, // Release 0-1
};
```

**çµè«–**: Flourish 100% ç¬¦åˆ Supabase é©ç”¨å ´æ™¯ã€‚

### æ±ºç­–éç¨‹

Sprint 8 æœŸé–“é€²è¡Œäº†å®Œæ•´çš„æŠ€è¡“è©•ä¼°ï¼š

1. **éƒ¨ç½²æ¸¬è©¦** (2025-11-06):
   - âœ… æˆåŠŸéƒ¨ç½² Render Staging ç’°å¢ƒ
   - âœ… æ¸¬è©¦ç’°å¢ƒè®Šæ•¸é…ç½®ï¼ˆ6 å€‹è®Šæ•¸ï¼‰
   - âœ… é©—è­‰å¥åº·æª¢æŸ¥ç«¯é» (`/health/liveness`, `/health/readiness`)
   - âœ… ä¿®å¾© TypeScript ç·¨è­¯éŒ¯èª¤
   - âœ… èª¿æ•´ç’°å¢ƒé©—è­‰ schema

2. **æ–‡æª”æ’°å¯«** (2025-11-06):
   - âœ… å®Œæ•´çš„ Render éƒ¨ç½²æŒ‡å—ï¼ˆç¹é«”ä¸­æ–‡ï¼‰
   - âœ… Staging ç’°å¢ƒè¨­ç½®æ–‡æª”
   - âœ… Production ç’°å¢ƒè¨­ç½®æ–‡æª”
   - âœ… Keep-Alive ç›£æ§æŒ‡å—
   - âœ… Git å·¥ä½œæµç¨‹æ–‡æª”

3. **å•é¡Œè­˜åˆ¥** (2025-11-07):
   - æˆæœ¬è€ƒé‡ï¼šFree tier æœƒä¼‘çœ ï¼ŒStarter Plan $7/æœˆ
   - ç¶­è­·è¤‡é›œåº¦ï¼šéœ€ç®¡ç† staging + production é›™ç’°å¢ƒ
   - é–‹ç™¼è² æ“”ï¼šæ¯å€‹åŠŸèƒ½éœ€æ‰‹å¯« API endpoints
   - éåº¦è¨­è¨ˆï¼šç•¶å‰éœ€æ±‚ä¸éœ€è¦å®Œæ•´çš„ API layer

4. **æ¶æ§‹æ±ºç­–** (2025-11-07):
   - æ¯”è¼ƒ NestJS vs Supabase
   - å‰µå»º ADR 001 æ–‡æª”
   - æ±ºå®šæ¡ç”¨ Supabase

5. **å¯¦æ–½** (Sprint 9):
   - å‰µå»º `packages/supabase-client`
   - å°å­˜ `apps/api` (NestJS)
   - æ•´åˆ Supabase åˆ°å‰ç«¯
   - è¨­ç½® RLS policies

### å¯¦æ–½çµæœ

**Sprint 9 (2025-11-13 ~ 2025-11-21) å®Œæˆé·ç§»**:

```typescript
// packages/supabase-client çµæ§‹
packages/supabase-client/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ client.ts         // Supabase client åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ server.ts         // Server-side client
â”‚   â”‚   â””â”€â”€ middleware.ts     // Next.js Middleware
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”œâ”€â”€ auth/             // èªè­‰ç›¸é—œ
â”‚   â”‚   â”œâ”€â”€ transactions/     // äº¤æ˜“ CRUD
â”‚   â”‚   â”œâ”€â”€ categories/       // é¡åˆ¥ CRUD
â”‚   â”‚   â””â”€â”€ cards/            // å¡ç‰‡ CRUD
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ database.types.ts // è‡ªå‹•ç”Ÿæˆçš„ TypeScript types
â””â”€â”€ package.json
```

**å¯¦éš›æ•ˆæœ**:

- âœ… å®Œå…¨ç§»é™¤ NestJS API
- âœ… å‰ç«¯ç›´æ¥é€£æ¥ Supabase
- âœ… RLS ç­–ç•¥æ­£å¸¸é‹ä½œ
- âœ… é¡å‹å®‰å…¨çš„è³‡æ–™å­˜å–
- âœ… éƒ¨ç½²æˆæœ¬é™è‡³ $0/æœˆ

---

## âš–ï¸ æ¬Šè¡¡èˆ‡é™åˆ¶

### å„ªå‹¢ âœ…

#### 1. æˆæœ¬å„ªå‹¢

- **$0/æœˆ** vs $7+/æœˆï¼ˆ100% ç¯€çœï¼‰
- ç„¡éœ€é¡å¤–çš„ä¼ºæœå™¨ç®¡ç†æˆæœ¬
- å…è²»å±¤ç´šå®Œå…¨è¶³å¤  Release 0-1

#### 2. é–‹ç™¼å„ªå‹¢

- **é–‹ç™¼é€Ÿåº¦å¿« 75%**ï¼ˆ45 min vs 3 hours for CRUDï¼‰
- è‡ªå‹•ç”Ÿæˆ TypeScript types
- å³æ™‚çš„ API æ›´æ–°ï¼ˆç„¡éœ€é‡æ–°éƒ¨ç½²ï¼‰
- å…§å»ºçš„ Realtime subscriptionsï¼ˆæœªä¾†å¯ç”¨ï¼‰
- å®Œå–„çš„é–‹ç™¼è€…å·¥å…·ï¼ˆSupabase Studioï¼‰

#### 3. ç¶­è­·å„ªå‹¢

- **æ¸›å°‘ 70% ç¶­è­·å·¥ä½œ**
- Supabase ç®¡ç†åŸºç¤è¨­æ–½
- è‡ªå‹•å‚™ä»½èˆ‡æ“´å±•
- å…§å»ºç›£æ§èˆ‡æ—¥èªŒ

#### 4. å®‰å…¨å„ªå‹¢

- Row Level Security (RLS) å¼·åˆ¶åŸ·è¡Œ
- è³‡æ–™åº«å±¤ç´šçš„æ¬Šé™æ§åˆ¶
- Supabase ç®¡ç†åŸºç¤è¨­æ–½å®‰å…¨
- è‡ªå‹•è™•ç† SQL injection é˜²è­·

#### 5. æ“´å±•å„ªå‹¢

- Supabase å¯ç„¡ç¸«æ“´å±•åˆ°ä»˜è²»æ–¹æ¡ˆ
- Edge Functions å¯è™•ç†è¤‡é›œé‚è¼¯ï¼ˆå¦‚æœªä¾†éœ€è¦ï¼‰
- æ”¯æ´ Realtimeã€Storageã€Edge Functions ç­‰é€²éšåŠŸèƒ½
- è³‡æ–™åº«æ•ˆèƒ½éš¨æ–¹æ¡ˆæå‡

### é™åˆ¶ âŒ

#### 1. æ¥­å‹™é‚è¼¯åˆ†æ•£åœ¨å‰ç«¯

**å•é¡Œ**:

- è¤‡é›œé‚è¼¯å¯èƒ½é‡è¤‡æˆ–é›£ä»¥ç¶­è­·
- ç¼ºä¹çµ±ä¸€çš„æ¥­å‹™é‚è¼¯å±¤
- å‰ç«¯æ‰¿æ“”æ›´å¤šè²¬ä»»

**ç·©è§£ç­–ç•¥**:

- ä½¿ç”¨ **Row Level Security (RLS) policies** åœ¨è³‡æ–™åº«å±¤å¼·åˆ¶æ¥­å‹™è¦å‰‡
- è¤‡é›œè¨ˆç®—ç”¨ **Supabase Database Functions**ï¼ˆPostgreSQL stored proceduresï¼‰
- æœªä¾†å¦‚éœ€è¦å¯ç”¨ **Edge Functions** è™•ç†è¤‡é›œæ¥­å‹™é‚è¼¯
- å»ºç«‹çµ±ä¸€çš„ **data access layer** (`packages/supabase-client`)

**å¯¦éš›æ¡ˆä¾‹**:

```sql
-- RLS Policy ç¯„ä¾‹ï¼šä½¿ç”¨è€…åªèƒ½å­˜å–è‡ªå·±çš„äº¤æ˜“
CREATE POLICY "Users can view own transactions"
  ON transactions FOR SELECT
  USING (auth.uid() = user_id);

-- Database Function ç¯„ä¾‹ï¼šè¨ˆç®—æœˆåº¦æ”¯å‡º
CREATE OR REPLACE FUNCTION get_monthly_spending(
  p_user_id UUID,
  p_year INTEGER,
  p_month INTEGER
)
RETURNS NUMERIC AS $$
  SELECT COALESCE(SUM(amount), 0)
  FROM transactions
  WHERE user_id = p_user_id
    AND type = 'EXPENSE'
    AND EXTRACT(YEAR FROM date) = p_year
    AND EXTRACT(MONTH FROM date) = p_month;
$$ LANGUAGE SQL STABLE;
```

#### 2. ç¬¬ä¸‰æ–¹æ•´åˆæŒ‘æˆ°

**å•é¡Œ**:

- API keys æš´éœ²é¢¨éšªï¼ˆå‰ç«¯ç„¡æ³•å®‰å…¨å„²å­˜å¯†é‘°ï¼‰
- CORS å•é¡Œï¼ˆè·¨åŸŸè«‹æ±‚é™åˆ¶ï¼‰
- Rate limiting é›£ä»¥å¯¦æ–½

**ç·©è§£ç­–ç•¥**:

- Release 0-1 **ç„¡ç¬¬ä¸‰æ–¹æ•´åˆéœ€æ±‚**ï¼ˆä¸æ˜¯ç«‹å³å•é¡Œï¼‰
- æœªä¾†å¯ç”¨ **Supabase Edge Functions**:

  ```typescript
  // supabase/functions/call-third-party/index.ts
  export async function handler(req: Request) {
    const apiKey = Deno.env.get('THIRD_PARTY_API_KEY'); // å®‰å…¨
    const response = await fetch('https://api.example.com', {
      headers: { Authorization: `Bearer ${apiKey}` },
    });
    return new Response(JSON.stringify(await response.json()));
  }
  ```

- æˆ–å›é€€åˆ°**ç¨ç«‹ API server**ï¼ˆNestJS æ–‡æª”å·²å­˜æª”ï¼‰

#### 3. å­¸ç¿’æ›²ç·š

**å•é¡Œ**:

- åœ˜éšŠï¼ˆç›®å‰åªæœ‰ä½ ï¼‰éœ€è¦å­¸ç¿’ Supabase
- SQL çŸ¥è­˜è¦æ±‚è¼ƒé«˜ï¼ˆç›¸æ¯” ORMï¼‰
- RLS policies éœ€è¦æ™‚é–“æŒæ¡

**ç·©è§£ç­–ç•¥**:

- Supabase **æ–‡æª”å®Œå–„**ï¼ˆå®˜æ–¹ + ç¤¾ç¾¤ï¼‰
- ç¤¾ç¾¤**æ´»èº**ï¼ˆDiscordã€GitHub Discussionsï¼‰
- å­¸ç¿’æ›²ç·š**è¼ƒ NestJS å¹³ç·©**ï¼ˆ3-4 é€± vs 6-8 é€±ï¼‰
- ADR 002 æ±ºå®šä½¿ç”¨ **Imperative Migrations** ä»¥æå‡ SQL æŠ€èƒ½

**å­¸ç¿’è·¯å¾‘**:

```
Week 1: SQL åŸºç¤
  - PostgreSQL åŸºæœ¬èªæ³•
  - CRUD æ“ä½œ
  - JOIN æŸ¥è©¢
  - Indexes èˆ‡æ•ˆèƒ½

Week 2: RLS ç†è§£
  - Row Level Security æ¦‚å¿µ
  - Policy æ’°å¯«
  - auth.uid() ä½¿ç”¨
  - æ¸¬è©¦èˆ‡é™¤éŒ¯

Week 3: Supabase Client API
  - JavaScript client ä½¿ç”¨
  - TypeScript types æ•´åˆ
  - Server Components æ•´åˆ
  - Middleware è¨­ç½®

Week 4: Real-world Application
  - è¤‡é›œæŸ¥è©¢
  - Database Functions
  - éŒ¯èª¤è™•ç†
  - æ•ˆèƒ½å„ªåŒ–
```

#### 4. ä¾›æ‡‰å•†é–å®š (Vendor Lock-in)

**å•é¡Œ**:

- ä¾è³´ Supabase å°ˆå±¬åŠŸèƒ½ï¼ˆRLSã€Authã€Edge Functionsï¼‰
- é·ç§»åˆ°å…¶ä»–å¹³å°æˆæœ¬è¼ƒé«˜
- å®šåƒ¹è®Šå‹•é¢¨éšª

**ç·©è§£ç­–ç•¥**:

- Supabase æ˜¯**é–‹æºå°ˆæ¡ˆ**ï¼ˆå¯è‡ªè¡Œéƒ¨ç½²ï¼‰
- æ ¸å¿ƒæ˜¯ **PostgreSQL**ï¼ˆæ¨™æº–è³‡æ–™åº«ï¼‰
- RLS æ˜¯ **PostgreSQL åŸç”ŸåŠŸèƒ½**ï¼ˆé Supabase å°ˆå±¬ï¼‰
- é·ç§»è·¯å¾‘å·²è¦åŠƒï¼ˆè¦‹ä¸‹æ–¹ï¼‰

### é¢¨éšªè©•ä¼°èˆ‡ç·©è§£

| é¢¨éšª              | åš´é‡æ€§ | å¯èƒ½æ€§ | ç·©è§£ç­–ç•¥                                  | ç‹€æ…‹        |
| ----------------- | ------ | ------ | ----------------------------------------- | ----------- |
| æ¥­å‹™é‚è¼¯åˆ†æ•£      | ä¸­     | é«˜     | RLS + Database Functions + Edge Functions | âœ… å·²ç·©è§£   |
| ç¬¬ä¸‰æ–¹æ•´åˆå›°é›£    | ä½     | ä½     | Edge Functions æˆ–ç¨ç«‹ API                 | ğŸ“‹ æœªä¾†è™•ç† |
| å­¸ç¿’æ›²ç·šé™¡å³­      | ä¸­     | ä¸­     | æ–‡æª”å­¸ç¿’ + Imperative Migrations          | âœ… é€²è¡Œä¸­   |
| ä¾›æ‡‰å•†é–å®š        | ä½     | ä½     | é–‹æº + PostgreSQL + é·ç§»è¨ˆåŠƒ              | âœ… å·²è¦åŠƒ   |
| å…è²»å±¤ç´šè¶…é™      | ä½     | ä½     | å‡ç´šåˆ° Pro æ–¹æ¡ˆ ($25/æœˆ)                  | ğŸ“‹ æœªä¾†è©•ä¼° |
| Supabase æœå‹™ä¸­æ–· | ä½     | æ¥µä½   | è‡ªè¡Œéƒ¨ç½²æˆ–é·ç§»åˆ°å…¶ä»–å¹³å°                  | ğŸ“‹ å‚™æ´è¨ˆåŠƒ |

---

## ğŸ”„ èˆ‡å…¶ä»–æ–¹æ¡ˆæ¯”è¼ƒ

### è©•ä¼°çš„æ–¹æ¡ˆ

åœ¨ Sprint 8 æœŸé–“ï¼Œæˆ‘å€‘è©•ä¼°äº†ä»¥ä¸‹æ¶æ§‹æ–¹æ¡ˆï¼š

1. **NestJS + Render** (åŸè¨ˆåŠƒ)
2. **Supabase** (æœ€çµ‚é¸æ“‡)
3. **Firebase** (è©•ä¼°å¾Œæ’é™¤)
4. **AWS Amplify** (è©•ä¼°å¾Œæ’é™¤)
5. **Prisma + Express + Render** (è©•ä¼°å¾Œæ’é™¤)

### æ±ºç­–çŸ©é™£

#### å®Œæ•´æ¯”è¼ƒè¡¨

| è©•ä¼°é¢å‘          | Supabase          | NestJS + Render | Firebase          | AWS Amplify       | Prisma + Express |
| ----------------- | ----------------- | --------------- | ----------------- | ----------------- | ---------------- |
| **æˆæœ¬**          |                   |                 |                   |                   |                  |
| å…è²»å±¤ç´š          | âœ… 50K MAU        | âŒ ç„¡           | âœ… æœ‰é™é¡         | âœ… æœ‰é™é¡         | âŒ ç„¡            |
| å…¥é–€è²»ç”¨          | $0                | $7/æœˆ           | $0                | $0                | $7/æœˆ            |
| ä»˜è²»æ–¹æ¡ˆ          | $25/æœˆ (Pro)      | $7/æœˆèµ·         | ä¾ç”¨é‡            | ä¾ç”¨é‡            | $7/æœˆèµ·          |
| **é–‹ç™¼æ•ˆç‡**      |                   |                 |                   |                   |                  |
| CRUD é–‹ç™¼æ™‚é–“     | 45 åˆ†é˜           | 3 å°æ™‚          | 1 å°æ™‚            | 1.5 å°æ™‚          | 2.5 å°æ™‚         |
| API è‡ªå‹•ç”Ÿæˆ      | âœ… REST           | âŒ æ‰‹å¯«         | âœ… Firebase SDK   | âœ… GraphQL/REST   | âŒ æ‰‹å¯«          |
| TypeScript æ”¯æ´   | âœ… è‡ªå‹•ç”Ÿæˆ       | âœ… æ‰‹å¯«         | âš ï¸ éƒ¨åˆ†           | âœ… è‡ªå‹•ç”Ÿæˆ       | âœ… Prisma Client |
| æœ¬åœ°é–‹ç™¼          | âœ… CLI æ”¯æ´       | âœ… å®Œæ•´         | âš ï¸ Emulator       | âš ï¸ è¤‡é›œ           | âœ… å®Œæ•´          |
| **èªè­‰**          |                   |                 |                   |                   |                  |
| å…§å»ºèªè­‰          | âœ… Supabase Auth  | âŒ éœ€å¯¦ä½œ       | âœ… Firebase Auth  | âœ… Cognito        | âŒ éœ€å¯¦ä½œ        |
| OAuth æ•´åˆ        | âœ… å¤šç¨® providers | âš ï¸ æ‰‹å‹•æ•´åˆ     | âœ… å¤šç¨® providers | âœ… å¤šç¨® providers | âš ï¸ æ‰‹å‹•æ•´åˆ      |
| Session ç®¡ç†      | âœ… è‡ªå‹•           | âŒ æ‰‹å‹•         | âœ… è‡ªå‹•           | âœ… è‡ªå‹•           | âŒ æ‰‹å‹•          |
| **è³‡æ–™åº«**        |                   |                 |                   |                   |                  |
| è³‡æ–™åº«é¡å‹        | PostgreSQL        | PostgreSQL      | NoSQL             | DynamoDB / Aurora | PostgreSQL       |
| RLS æ”¯æ´          | âœ… åŸç”Ÿ           | âš ï¸ éœ€å¯¦ä½œ       | âœ… Security Rules | âš ï¸ IAM            | âš ï¸ éœ€å¯¦ä½œ        |
| é—œè¯æŸ¥è©¢          | âœ… SQL JOIN       | âœ… Prisma       | âŒ æ‰‹å‹•           | âš ï¸ è¤‡é›œ           | âœ… Prisma        |
| å³æ™‚è¨‚é–±          | âœ… Realtime       | âŒ éœ€å¯¦ä½œ       | âœ… Firestore      | âš ï¸ AppSync        | âŒ éœ€å¯¦ä½œ        |
| **ç¶­è­·**          |                   |                 |                   |                   |                  |
| ä¼ºæœå™¨ç®¡ç†        | âŒ ç„¡éœ€           | âœ… Render ç®¡ç†  | âŒ ç„¡éœ€           | âŒ ç„¡éœ€           | âœ… Render ç®¡ç†   |
| å‚™ä»½              | âœ… è‡ªå‹•           | âš ï¸ éœ€è¨­å®š       | âœ… è‡ªå‹•           | âœ… è‡ªå‹•           | âš ï¸ éœ€è¨­å®š        |
| ç›£æ§              | âœ… å…§å»º           | âš ï¸ éœ€è¨­å®š       | âœ… å…§å»º           | âœ… å…§å»º           | âš ï¸ éœ€è¨­å®š        |
| æ“´å±•æ€§            | âœ… è‡ªå‹•           | âš ï¸ æ‰‹å‹•         | âœ… è‡ªå‹•           | âœ… è‡ªå‹•           | âš ï¸ æ‰‹å‹•          |
| **å­¸ç¿’æ›²ç·š**      |                   |                 |                   |                   |                  |
| å­¸ç¿’æ™‚é–“          | 3-4 é€±            | 6-8 é€±          | 2-3 é€±            | 4-6 é€±            | 5-7 é€±           |
| æ–‡æª”å“è³ª          | âœ… å„ªç§€           | âœ… å„ªç§€         | âœ… å„ªç§€           | âš ï¸ è¤‡é›œ           | âœ… å„ªç§€          |
| ç¤¾ç¾¤æ”¯æ´          | âœ… æ´»èº           | âœ… æ´»èº         | âœ… æ´»èº           | âš ï¸ åˆ†æ•£           | âœ… æ´»èº          |
| **Flourish é©é…** |                   |                 |                   |                   |                  |
| CRUD æ“ä½œ         | âœ…âœ…âœ…            | âœ…âœ…            | âœ…âœ…              | âœ…                | âœ…âœ…             |
| è¤‡é›œæŸ¥è©¢          | âœ…âœ…âœ…            | âœ…âœ…âœ…          | âŒ                | âš ï¸                | âœ…âœ…âœ…           |
| ä½¿ç”¨è€…éš”é›¢        | âœ…âœ…âœ…            | âœ…âœ…            | âœ…âœ…              | âœ…                | âœ…âœ…             |
| æª”æ¡ˆä¸Šå‚³          | âœ… Storage        | âŒ éœ€å¯¦ä½œ       | âœ… Storage        | âœ… S3             | âŒ éœ€å¯¦ä½œ        |
| **ç¸½è©•åˆ†**        | **9.5/10**        | **7.0/10**      | **6.5/10**        | **6.0/10**        | **6.5/10**       |

#### è©³ç´°æ¯”è¼ƒï¼šSupabase vs NestJS

**æ¶æ§‹å°æ¯”**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Architecture                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Frontend (Vercel)                                          â”‚
â”‚       â”‚                                                     â”‚
â”‚       â”‚ @supabase/supabase-js                              â”‚
â”‚       â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Supabase                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ PostgreSQL + RLS + Triggers + Functions      â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ PostgREST (Auto-generated REST API)         â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ GoTrue (Authentication)                      â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Storage (S3-compatible)                      â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Realtime (WebSocket subscriptions)          â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Edge Functions (Deno serverless)            â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  Cost: $0/æœˆ (Free tier)                                   â”‚
â”‚  Maintenance: Supabase ç®¡ç†                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NestJS Architecture                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Frontend (Vercel)                                          â”‚
â”‚       â”‚                                                     â”‚
â”‚       â”‚ fetch() / axios                                     â”‚
â”‚       â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ NestJS API (Render)                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Controllers (è·¯ç”± + é©—è­‰)                     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Services (æ¥­å‹™é‚è¼¯)                           â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ DTOs (é©—è­‰ + é¡å‹)                            â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Guards (èªè­‰ + æˆæ¬Š)                          â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Prisma (ORM)                                 â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                     â”‚
â”‚       â”‚ Database Connection                                 â”‚
â”‚       â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Supabase PostgreSQL                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  Cost: $7+/æœˆ (Render Starter)                             â”‚
â”‚  Maintenance: é–‹ç™¼è€…ç®¡ç† API + é…ç½®                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é–‹ç™¼å·¥ä½œæµç¨‹å°æ¯”**:

```typescript
// ============================================================
// Supabase å·¥ä½œæµç¨‹ï¼ˆç°¡åŒ– 75%ï¼‰
// ============================================================

// 1. å®šç¾© Schemaï¼ˆSQLï¼‰
CREATE TABLE transactions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users NOT NULL,
  amount NUMERIC(10,2) NOT NULL,
  description TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

// 2. è¨­ç½® RLSï¼ˆSQLï¼‰
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Users can view own transactions"
  ON transactions FOR SELECT USING (auth.uid() = user_id);

// 3. å‰ç«¯ç›´æ¥ä½¿ç”¨ï¼ˆTypeScriptï¼‰- è‡ªå‹•ç”Ÿæˆ API
const { data, error } = await supabase
  .from('transactions')
  .select('*')
  .eq('user_id', userId)
  .order('created_at', { ascending: false });

// âœ… å®Œæˆï¼ç¸½å…± ~45 åˆ†é˜

// ============================================================
// NestJS å·¥ä½œæµç¨‹ï¼ˆå®Œæ•´æµç¨‹ï¼‰
// ============================================================

// 1. Prisma Schema
model Transaction {
  id          String   @id @default(uuid())
  userId      String   @map("user_id")
  amount      Decimal  @db.Decimal(10, 2)
  description String?
  createdAt   DateTime @default(now()) @map("created_at")
  user        User     @relation(fields: [userId], references: [id])
}

// 2. DTO (create-transaction.dto.ts)
export class CreateTransactionDto {
  @IsNumber()
  @Min(0)
  amount: number;

  @IsString()
  @IsOptional()
  description?: string;
}

// 3. DTO (transaction-response.dto.ts)
export class TransactionResponseDto {
  id: string;
  userId: string;
  amount: number;
  description: string | null;
  createdAt: Date;
}

// 4. Service (transactions.service.ts)
@Injectable()
export class TransactionsService {
  constructor(private prisma: PrismaService) {}

  async findAllByUser(userId: string): Promise<Transaction[]> {
    return this.prisma.transaction.findMany({
      where: { userId },
      orderBy: { createdAt: 'desc' },
    });
  }

  async create(
    userId: string,
    dto: CreateTransactionDto
  ): Promise<Transaction> {
    return this.prisma.transaction.create({
      data: { ...dto, userId },
    });
  }
}

// 5. Controller (transactions.controller.ts)
@Controller('transactions')
@UseGuards(JwtAuthGuard)
export class TransactionsController {
  constructor(private service: TransactionsService) {}

  @Get()
  async findAll(@Request() req): Promise<TransactionResponseDto[]> {
    const transactions = await this.service.findAllByUser(req.user.id);
    return transactions.map(t => new TransactionResponseDto(t));
  }

  @Post()
  async create(
    @Request() req,
    @Body() dto: CreateTransactionDto
  ): Promise<TransactionResponseDto> {
    const transaction = await this.service.create(req.user.id, dto);
    return new TransactionResponseDto(transaction);
  }
}

// 6. Module (transactions.module.ts)
@Module({
  controllers: [TransactionsController],
  providers: [TransactionsService],
  exports: [TransactionsService],
})
export class TransactionsModule {}

// 7. æ¸¬è©¦ (transactions.service.spec.ts)
describe('TransactionsService', () => {
  it('should create transaction', async () => {
    // æ¸¬è©¦å¯¦ä½œ...
  });
});

// âœ… å®Œæˆï¼ç¸½å…± ~3 å°æ™‚

// çµè«–ï¼šSupabase ç¯€çœ 75% é–‹ç™¼æ™‚é–“
```

#### ç‚ºä½•ä¸é¸ Firebaseï¼Ÿ

**å„ªé»**:

- å®Œæ•´çš„ BaaS å¹³å°
- å„ªç§€çš„ Realtime æ”¯æ´
- å¼·å¤§çš„ Authentication
- è‰¯å¥½çš„æ–‡æª”

**ç¼ºé»**ï¼ˆå°è‡´æ’é™¤ï¼‰:

- âŒ **NoSQL è³‡æ–™åº«**ï¼ˆFirestoreï¼‰ä¸é©åˆé—œè¯å¼è³‡æ–™
- âŒ Flourish éœ€è¦è¤‡é›œçš„ JOIN æŸ¥è©¢ï¼ˆäº¤æ˜“ + é¡åˆ¥ + å¡ç‰‡ï¼‰
- âŒ NoSQL çš„è³‡æ–™ä¸€è‡´æ€§è¼ƒå¼±
- âŒ é·ç§»è·¯å¾‘è¤‡é›œï¼ˆNoSQL â†’ SQLï¼‰

**å¯¦éš›å½±éŸ¿**:

```javascript
// âŒ Firebase Firestoreï¼ˆNoSQLï¼‰- é—œè¯æŸ¥è©¢å›°é›£
// éœ€è¦å¤šæ¬¡æŸ¥è©¢ä¸¦æ‰‹å‹•åˆä½µ
const transactionsSnapshot = await db
  .collection('transactions')
  .where('userId', '==', userId)
  .get();

const transactions = await Promise.all(
  transactionsSnapshot.docs.map(async (doc) => {
    const data = doc.data();
    // éœ€è¦é¡å¤–æŸ¥è©¢ category
    const categoryDoc = await db.collection('categories').doc(data.categoryId).get();
    // éœ€è¦é¡å¤–æŸ¥è©¢ card
    const cardDoc = await db.collection('cards').doc(data.cardId).get();
    return {
      ...data,
      category: categoryDoc.data(),
      card: cardDoc.data(),
    };
  })
);

// âœ… Supabaseï¼ˆPostgreSQLï¼‰- é—œè¯æŸ¥è©¢ç°¡å–®
const { data: transactions } = await supabase
  .from('transactions')
  .select('*, category:categories(*), card:cards(*)')
  .eq('user_id', userId);
```

#### ç‚ºä½•ä¸é¸ AWS Amplifyï¼Ÿ

**å„ªé»**:

- AWS ç”Ÿæ…‹ç³»æ•´åˆ
- å¼·å¤§çš„æ“´å±•æ€§
- è±å¯Œçš„åŠŸèƒ½

**ç¼ºé»**ï¼ˆå°è‡´æ’é™¤ï¼‰:

- âŒ **å­¸ç¿’æ›²ç·šé™¡å³­**ï¼ˆAWS æœå‹™è¤‡é›œï¼‰
- âŒ é…ç½®è¤‡é›œï¼ˆéœ€è¦ç†è§£å¤šå€‹ AWS æœå‹™ï¼‰
- âŒ æˆæœ¬ä¸é€æ˜ï¼ˆå¤šå€‹æœå‹™è¨ˆè²»ï¼‰
- âŒ éåº¦è¨­è¨ˆï¼ˆFlourish ä¸éœ€è¦ AWS ç­‰ç´šçš„åŸºç¤è¨­æ–½ï¼‰

**å¯¦éš›å½±éŸ¿**:

- Amplify éœ€è¦ç†è§£ï¼šCognitoã€AppSyncã€DynamoDBã€Lambdaã€S3 ç­‰
- Supabase ä¸€ç«™å¼è§£æ±ºæ–¹æ¡ˆï¼Œå­¸ç¿’æ›²ç·šå¹³ç·©

### æ±ºç­–çŸ©é™£ç¸½çµ

| æ–¹æ¡ˆ             | æˆæœ¬   | é–‹ç™¼æ•ˆç‡ | ç¶­è­·   | å­¸ç¿’æ›²ç·š | Flourish é©é… | ç¸½åˆ†       |
| ---------------- | ------ | -------- | ------ | -------- | ------------- | ---------- |
| **Supabase**     | âœ…âœ…âœ… | âœ…âœ…âœ…   | âœ…âœ…âœ… | âœ…âœ…     | âœ…âœ…âœ…        | **9.5/10** |
| NestJS + Render  | âš ï¸     | âš ï¸âš ï¸     | âš ï¸     | âš ï¸       | âœ…âœ…âœ…        | 7.0/10     |
| Firebase         | âœ…âœ…   | âœ…âœ…     | âœ…âœ…âœ… | âœ…âœ…âœ…   | âŒ            | 6.5/10     |
| AWS Amplify      | âš ï¸âš ï¸   | âš ï¸       | âœ…âœ…   | âŒ       | âœ…âœ…          | 6.0/10     |
| Prisma + Express | âš ï¸     | âš ï¸       | âš ï¸     | âš ï¸âš ï¸     | âœ…âœ…âœ…        | 6.5/10     |

**çµè«–**: Supabase åœ¨æ‰€æœ‰è©•ä¼°é¢å‘éƒ½è¡¨ç¾æœ€ä½³ï¼Œç‰¹åˆ¥æ˜¯æˆæœ¬ã€é–‹ç™¼æ•ˆç‡ã€å’Œ Flourish çš„é©é…æ€§ã€‚

---

## ğŸ“ˆ æœªä¾†è€ƒé‡

### ä½•æ™‚éœ€è¦é‡æ–°è©•ä¼°ï¼Ÿ

#### è§¸ç™¼æ¢ä»¶

| è§¸ç™¼æ¢ä»¶             | é–¾å€¼           | ç•¶å‰ç‹€æ…‹ | è¡Œå‹•        |
| -------------------- | -------------- | -------- | ----------- |
| **ä½¿ç”¨è€…é‡**         | > 50K MAU      | < 100    | ğŸ“Š ç›£æ§ä¸­   |
| **è³‡æ–™åº«å„²å­˜**       | > 500MB        | < 50MB   | ğŸ“Š ç›£æ§ä¸­   |
| **API è«‹æ±‚é‡**       | > 500K/æœˆ      | < 10K/æœˆ | ğŸ“Š ç›£æ§ä¸­   |
| **éœ€è¦è¤‡é›œæ¥­å‹™é‚è¼¯** | å¤šæ­¥é©Ÿå·¥ä½œæµç¨‹ | ç„¡       | ğŸ“‹ æœªä¾†è©•ä¼° |
| **ç¬¬ä¸‰æ–¹æ•´åˆ**       | > 3 å€‹æœå‹™     | 0        | ğŸ“‹ æœªä¾†è©•ä¼° |
| **æª”æ¡ˆä¸Šå‚³éœ€æ±‚**     | > 1GB          | 0GB      | ğŸ“‹ æœªä¾†è©•ä¼° |
| **Realtime éœ€æ±‚**    | å¤šä½¿ç”¨è€…å”ä½œ   | ç„¡       | ğŸ“‹ æœªä¾†è©•ä¼° |

#### å¯©æŸ¥æ™‚æ©Ÿ

1. **Release 1 å®Œæˆå¾Œ** (é è¨ˆ 2025-12)
   - è©•ä¼° Authentication å¯¦ä½œç¶“é©—
   - æª¢è¦– RLS policies ç¶­è­·è² æ“”
   - è©•ä¼°æ•´é«”é–‹ç™¼é«”é©—

2. **ä½¿ç”¨è€…é‡é” 1000 å¾Œ**
   - åˆ†ææ•ˆèƒ½ç“¶é ¸
   - è©•ä¼°æ˜¯å¦éœ€è¦å‡ç´šæ–¹æ¡ˆ
   - æª¢è¦–æˆæœ¬æ•ˆç›Š

3. **éœ€è¦è¤‡é›œæ¥­å‹™é‚è¼¯æ™‚**
   - è©•ä¼° Edge Functions æ˜¯å¦è¶³å¤ 
   - è€ƒæ…®æ˜¯å¦éœ€è¦ç¨ç«‹ API server
   - é‡æ–°è©•ä¼°æ¶æ§‹éœ€æ±‚

4. **æ¯å­£åº¦å®šæœŸå¯©æŸ¥**
   - æª¢è¦– Supabase ä½¿ç”¨é‡
   - è©•ä¼°æ–°åŠŸèƒ½éœ€æ±‚
   - æ›´æ–°æ¶æ§‹æ±ºç­–è¨˜éŒ„

### å¯èƒ½çš„é·ç§»è·¯å¾‘

#### è·¯å¾‘ 1: Supabase å‡ç´šï¼ˆæœ€å¯èƒ½ï¼‰

**æƒ…å¢ƒ**: ä½¿ç”¨è€…é‡æˆ–è³‡æ–™é‡è¶…éå…è²»å±¤ç´š

**æ–¹æ¡ˆ**: å‡ç´šåˆ° Supabase Pro æ–¹æ¡ˆ

```
Free Tier â†’ Pro ($25/æœˆ) â†’ Team ($599/æœˆ) â†’ Enterprise (å ±åƒ¹)
```

**å„ªå‹¢**:

- âœ… ç„¡éœ€æ¶æ§‹è®Šæ›´
- âœ… ç„¡ç¸«å‡ç´š
- âœ… æ›´é«˜çš„é™åˆ¶èˆ‡æ•ˆèƒ½
- âœ… å„ªå…ˆæŠ€è¡“æ”¯æ´

**ä½•æ™‚åŸ·è¡Œ**:

- ä½¿ç”¨è€…é‡ > 50K MAU
- è³‡æ–™åº«å„²å­˜ > 500MB
- éœ€è¦æ›´é«˜çš„ API è«‹æ±‚é‡
- éœ€è¦å„ªå…ˆæŠ€è¡“æ”¯æ´

#### è·¯å¾‘ 2: Supabase + Edge Functionsï¼ˆä¸­åº¦å¯èƒ½ï¼‰

**æƒ…å¢ƒ**: éœ€è¦å°‘æ•¸è¤‡é›œæ¥­å‹™é‚è¼¯æˆ–ç¬¬ä¸‰æ–¹æ•´åˆ

**æ–¹æ¡ˆ**: åœ¨ Supabase åŸºç¤ä¸Šæ·»åŠ  Edge Functions

```typescript
// supabase/functions/process-pdf/index.ts
import { serve } from 'https://deno.land/std@0.168.0/http/server.ts';
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';

serve(async (req) => {
  // 1. é©—è­‰ä½¿ç”¨è€…
  const supabase = createClient(Deno.env.get('SUPABASE_URL')!, Deno.env.get('SUPABASE_ANON_KEY')!, {
    global: {
      headers: { Authorization: req.headers.get('Authorization')! },
    },
  });

  const {
    data: { user },
    error: authError,
  } = await supabase.auth.getUser();
  if (authError || !user) {
    return new Response('Unauthorized', { status: 401 });
  }

  // 2. è¤‡é›œæ¥­å‹™é‚è¼¯ï¼ˆä¾‹å¦‚ï¼šAI PDF è§£æï¼‰
  const pdfUrl = new URL(req.url).searchParams.get('pdf_url');
  const apiKey = Deno.env.get('OPENAI_API_KEY'); // å®‰å…¨åœ°å„²å­˜å¯†é‘°

  const response = await fetch('https://api.openai.com/v1/...', {
    headers: { Authorization: `Bearer ${apiKey}` },
    // ...
  });

  const transactions = await response.json();

  // 3. å„²å­˜åˆ°è³‡æ–™åº«
  const { data, error } = await supabase
    .from('transactions')
    .insert(transactions.map((t) => ({ ...t, user_id: user.id })));

  return new Response(JSON.stringify(data), {
    headers: { 'Content-Type': 'application/json' },
  });
});
```

**å„ªå‹¢**:

- âœ… ä¿æŒ Supabase æ¶æ§‹
- âœ… ç„¡éœ€ç®¡ç†é¡å¤–ä¼ºæœå™¨
- âœ… Serverless è¨ˆè²»æ¨¡å¼
- âœ… èˆ‡ Supabase ç·Šå¯†æ•´åˆ

**ä½•æ™‚åŸ·è¡Œ**:

- éœ€è¦ AI/ML æ•´åˆï¼ˆPDF è§£æã€äº¤æ˜“åˆ†é¡ï¼‰
- éœ€è¦è¤‡é›œè¨ˆç®—ï¼ˆé ç®—å»ºè­°ã€è¶¨å‹¢é æ¸¬ï¼‰
- éœ€è¦ç¬¬ä¸‰æ–¹ API æ•´åˆï¼ˆéŠ€è¡Œ APIã€æ”¯ä»˜ APIï¼‰
- éœ€è¦å®šæ™‚ä»»å‹™ï¼ˆCron jobsï¼‰

#### è·¯å¾‘ 3: Supabase + NestJS APIï¼ˆä½å¯èƒ½ï¼‰

**æƒ…å¢ƒ**: éœ€è¦å¤§é‡è¤‡é›œå¾Œç«¯è™•ç†æˆ–åš´æ ¼çš„ API ç‰ˆæœ¬æ§åˆ¶

**æ–¹æ¡ˆ**: æ··åˆæ¶æ§‹ - å¤§éƒ¨åˆ†åŠŸèƒ½ç”¨ Supabaseï¼Œè¤‡é›œåŠŸèƒ½ç”¨ NestJS

```
å¤§éƒ¨åˆ†åŠŸèƒ½ (CRUD) â†’ Supabase ç›´é€£
è¤‡é›œåŠŸèƒ½ (AI, å·¥ä½œæµç¨‹) â†’ NestJS API â†’ Supabase Database
```

**å„ªå‹¢**:

- âœ… ä¿ç•™ Supabase ç°¡åŒ–çš„é–‹ç™¼é«”é©—
- âœ… NestJS è™•ç†è¤‡é›œé‚è¼¯
- âœ… æ¼¸é€²å¼é·ç§»ï¼ˆä¸éœ€è¦ä¸€æ¬¡æ€§é‡å¯«ï¼‰
- âœ… å·²æœ‰å®Œæ•´çš„ NestJS éƒ¨ç½²æ–‡æª”ï¼ˆå­˜æª”ï¼‰

**ä½•æ™‚åŸ·è¡Œ**:

- è¤‡é›œæ¥­å‹™é‚è¼¯è¶…é 5+ å€‹ Edge Functions
- éœ€è¦åš´æ ¼çš„ API ç‰ˆæœ¬æ§åˆ¶
- éœ€è¦èƒŒæ™¯ä»»å‹™è™•ç†ï¼ˆè¶…é Edge Functions é™åˆ¶ï¼‰
- åœ˜éšŠæˆé•·è‡³éœ€è¦å°ˆè·å¾Œç«¯å·¥ç¨‹å¸«

**å¯¦æ–½æ­¥é©Ÿ**:

```bash
# 1. æ¢å¾© NestJS APIï¼ˆå¾å­˜æª”ï¼‰
git checkout docs/archive/nestjs-api/

# 2. éƒ¨ç½²åˆ° Render
# ä½¿ç”¨å­˜æª”çš„éƒ¨ç½²æ–‡æª”

# 3. å‰ç«¯æ¼¸é€²å¼é·ç§»
// ç°¡å–® CRUD ä»ä½¿ç”¨ Supabase
const { data } = await supabase.from('transactions').select('*');

// è¤‡é›œåŠŸèƒ½ä½¿ç”¨ NestJS API
const response = await fetch('https://api.flourish.app/v1/ai/analyze-spending');
```

#### è·¯å¾‘ 4: å®Œå…¨é·ç§»åˆ° NestJSï¼ˆæ¥µä½å¯èƒ½ï¼‰

**æƒ…å¢ƒ**: Supabase ç„¡æ³•æ»¿è¶³éœ€æ±‚æˆ–æˆæœ¬éé«˜

**æ–¹æ¡ˆ**: å®Œå…¨å›åˆ° NestJS + Render æ¶æ§‹

**ä½•æ™‚åŸ·è¡Œ**ï¼ˆæ¥µç«¯æƒ…æ³ï¼‰:

- Supabase å®šåƒ¹å¤§å¹…ä¸Šæ¼²
- Supabase æœå‹™ç©©å®šæ€§å•é¡Œ
- ç›£ç®¡è¦æ±‚è‡ªè¡Œéƒ¨ç½²è³‡æ–™åº«
- éœ€è¦æ¥µåº¦å®¢è£½åŒ–çš„å¾Œç«¯é‚è¼¯

**å„ªå‹¢**:

- âœ… å®Œå…¨æ§åˆ¶å¾Œç«¯é‚è¼¯
- âœ… ç„¡ä¾›æ‡‰å•†é–å®š
- âœ… å·²æœ‰å®Œæ•´çš„éƒ¨ç½²æ–‡æª”ï¼ˆå­˜æª”ï¼‰

**æˆæœ¬**ï¼ˆåƒè€ƒ ADR 001 åˆ†æï¼‰:

- é–‹ç™¼æ™‚é–“å¢åŠ  60%
- ç¶­è­·å·¥ä½œå¢åŠ  70%
- éƒ¨ç½²æˆæœ¬ $7+/æœˆ

#### è·¯å¾‘ 5: è‡ªè¡Œéƒ¨ç½² Supabaseï¼ˆå‚™æ´é¸é …ï¼‰

**æƒ…å¢ƒ**: éœ€è¦å®Œå…¨æ§åˆ¶æˆ–é™ä½æˆæœ¬

**æ–¹æ¡ˆ**: ä½¿ç”¨ Docker è‡ªè¡Œéƒ¨ç½² Supabase

```bash
# ä½¿ç”¨å®˜æ–¹ Docker Compose
git clone https://github.com/supabase/supabase
cd docker
cp .env.example .env
docker-compose up -d
```

**å„ªå‹¢**:

- âœ… å®Œå…¨æ§åˆ¶åŸºç¤è¨­æ–½
- âœ… Supabase æ˜¯é–‹æºçš„
- âœ… ç„¡æ¶æ§‹è®Šæ›´ï¼ˆåªæ˜¯éƒ¨ç½²ä½ç½®ä¸åŒï¼‰

**æˆæœ¬**:

- ä¼ºæœå™¨æˆæœ¬ï¼ˆä¾‹å¦‚ï¼šDigitalOcean $12/æœˆï¼‰
- ç¶­è­·æ™‚é–“æˆæœ¬

**ä½•æ™‚åŸ·è¡Œ**:

- Supabase å®˜æ–¹æœå‹™ç„¡æ³•æ»¿è¶³ç›£ç®¡è¦æ±‚
- æˆæœ¬å„ªåŒ–ï¼ˆé•·æœŸä½¿ç”¨æƒ…æ³ä¸‹ï¼‰

### é·ç§»æ±ºç­–æ¨¹

```mermaid
flowchart TD
    Start([é–‹å§‹è©•ä¼°]) --> Q1{ä½¿ç”¨è€…é‡æˆ–<br/>è³‡æ–™é‡è¶…é™ï¼Ÿ}

    Q1 -->|æ˜¯| Sol1[å‡ç´š Supabase æ–¹æ¡ˆ<br/>Pro $25/æœˆ]
    Q1 -->|å¦| Q2{éœ€è¦è¤‡é›œ<br/>æ¥­å‹™é‚è¼¯ï¼Ÿ}

    Q2 -->|å°‘é‡<br/>1-5 å€‹åŠŸèƒ½| Sol2[ä½¿ç”¨ Edge Functions<br/>ä¿æŒ Supabase-first]
    Q2 -->|ä¸­é‡<br/>5-10 å€‹åŠŸèƒ½| Sol3[æ··åˆæ¶æ§‹<br/>Supabase + NestJS]
    Q2 -->|å¤§é‡<br/>10+ å€‹åŠŸèƒ½| Sol4[å®Œå…¨é·ç§»åˆ° NestJS<br/>è‡ªè¨‚ API æ¶æ§‹]
    Q2 -->|å¦| Q3{Supabase å®šåƒ¹<br/>æˆ–æœå‹™æœ‰å•é¡Œï¼Ÿ}

    Q3 -->|å®šåƒ¹å•é¡Œ| Sol5[è€ƒæ…®è‡ªè¡Œéƒ¨ç½²<br/>Supabase Docker]
    Q3 -->|æœå‹™å•é¡Œ| Sol6[è©•ä¼°é·ç§»åˆ°<br/>NestJS æˆ–å…¶ä»– BaaS]
    Q3 -->|å¦| Sol7[âœ… ç¹¼çºŒä½¿ç”¨<br/>Supabase Free Tier]

    Sol1 --> Review
    Sol2 --> Review
    Sol3 --> Review
    Sol4 --> Review
    Sol5 --> Review
    Sol6 --> Review
    Sol7 --> Review

    Review([ğŸ“… æ¯å­£åº¦å¯©æŸ¥ä¸€æ¬¡])

    style Sol7 fill:#c8e6c9
    style Sol1 fill:#fff3e0
    style Sol2 fill:#e3f2fd
    style Sol3 fill:#ffe0b2
    style Sol4 fill:#ffccbc
    style Sol5 fill:#f3e5f5
    style Sol6 fill:#ffcdd2
    style Review fill:#e0e0e0
```

**æ±ºç­–æŒ‡å—**ï¼š

- ğŸŸ¢ **ç¹¼çºŒ Supabase Free Tier**ï¼šç•¶å‰æœ€å„ªè§£ï¼ˆæˆæœ¬ $0ï¼Œç¬¦åˆéœ€æ±‚ï¼‰
- ğŸŸ¡ **å‡ç´šæˆ–æ“´å……**ï¼šä½¿ç”¨é‡å¢é•·æ™‚è€ƒæ…®ï¼ˆPro æ–¹æ¡ˆæˆ– Edge Functionsï¼‰
- ğŸŸ  **æ··åˆæ¶æ§‹**ï¼šè¤‡é›œæ¥­å‹™é‚è¼¯å¢åŠ æ™‚éæ¸¡æ–¹æ¡ˆ
- ğŸ”´ **å®Œå…¨é·ç§»**ï¼šæ¥­å‹™é‚è¼¯è¤‡é›œåº¦é¡¯è‘—å¢åŠ æ™‚é•·æœŸè§£æ±ºæ–¹æ¡ˆ

**é æœŸè©•ä¼°é€±æœŸ**ï¼šæ¯å­£åº¦å¯©æŸ¥ä¸€æ¬¡ï¼ˆæˆ–ç•¶ä½¿ç”¨é‡/åŠŸèƒ½éœ€æ±‚æœ‰é¡¯è‘—è®ŠåŒ–æ™‚ï¼‰

---

## ğŸ”— ADR 002: Imperative Migrations

**æ—¥æœŸ**: 2025-11-13
**æ±ºç­–è€…**: Henry Lee
**å®Œæ•´æ–‡æª”**: [ADR 002](../../decisions/002-imperative-migrations.md)

### æ±ºç­–æ‘˜è¦

ä½¿ç”¨ **Imperative Migrationsï¼ˆå‘½ä»¤å¼ SQL é·ç§»ï¼‰** è€Œé **Declarative Schemaï¼ˆå®£å‘Šå¼ Schemaï¼‰** ç®¡ç† Supabase è³‡æ–™åº«ã€‚

### é¸æ“‡åŸå› 

#### 1. å­¸ç¿’åƒ¹å€¼ï¼ˆä¸»è¦å› ç´ ï¼‰ ğŸ“

- Imperative migrations æä¾›å¯¦éš›çš„ **SQL ç·´ç¿’æ©Ÿæœƒ**
- å»ºç«‹æ‰å¯¦çš„ SQL æŠ€èƒ½å°å¾Œç«¯é–‹ç™¼è‡³é—œé‡è¦
- Declarative Schema å°‡ SQL æŠ½è±¡åŒ–ï¼Œæ¸›å°‘å­¸ç¿’æ©Ÿæœƒ
- ç¬¦åˆå€‹äººç™¼å±•ç›®æ¨™ï¼šæˆç‚ºå…¨ç«¯å·¥ç¨‹å¸«

#### 2. å°ˆæ¡ˆè¦æ¨¡ï¼ˆæ”¯æŒå› ç´ ï¼‰ ğŸ“

- å–®ä¸€é–‹ç™¼è€…ï¼ˆç„¡åœ˜éšŠå”èª¿è¤‡é›œåº¦ï¼‰
- å°å‹ schemaï¼ˆ7 å€‹è³‡æ–™è¡¨ï¼Œç´„ 30 å€‹æ¬„ä½ï¼‰
- ä½é·ç§»é »ç‡ï¼ˆé ä¼°æ¯æœˆä¸€æ¬¡æˆ–æ›´å°‘ï¼‰
- Declarative çš„ 70% é€Ÿåº¦å„ªå‹¢å°ä½é »è®Šæ›´å½±éŸ¿ä¸å¤§

#### 3. å·²ç¶“å®Œæˆï¼ˆå‹™å¯¦å› ç´ ï¼‰ âœ…

- Sprint 9, Task 2 å·²å®Œæˆ 4 å€‹ Imperative migrations
- æ‰€æœ‰é·ç§»éƒ½å·²æ¸¬è©¦ä¸¦æˆåŠŸéƒ¨ç½²
- Schema åœ¨æ­£å¼ç’°å¢ƒä¸­æ­£å¸¸é‹ä½œ
- åˆ‡æ›è‡³ Declarative éœ€è¦é‡æ–°å¯¦ä½œ

#### 4. æ§åˆ¶èˆ‡å¯é æ¸¬æ€§ï¼ˆæŠ€è¡“å› ç´ ï¼‰ ğŸ¯

- éœ€è¦æ˜ç¢ºæ§åˆ¶ Row Level Securityï¼ˆRLSï¼‰ç­–ç•¥
- è¤‡é›œçš„è§¸ç™¼å™¨å‡½å¼ç”¨æ–¼èªè­‰æ•´åˆ
- æ¥­å‹™é‚è¼¯çš„è¼”åŠ©å‡½å¼
- Imperative æä¾›å°é·ç§»é †åºçš„å®Œå…¨æ§åˆ¶

### å¯¦æ–½æˆæœ

**å®Œæˆçš„ 4 å€‹é·ç§»**:

```sql
-- 1. 20251113050233_initial_schema.sql
-- æ ¸å¿ƒè³‡æ–™è¡¨èˆ‡ ENUM å‹åˆ¥
CREATE TYPE transaction_type AS ENUM ('INCOME', 'EXPENSE', 'TRANSFER');
CREATE TYPE card_type AS ENUM ('CREDIT', 'DEBIT', 'CASH');
-- ... 7 å€‹è³‡æ–™è¡¨å®šç¾©

-- 2. 20251113054218_auth_integration.sql
-- è‡ªå‹•å»ºç«‹ä½¿ç”¨è€…è§¸ç™¼å™¨ + updated_at è§¸ç™¼å™¨
CREATE FUNCTION public.handle_new_user() RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.users (id, email, created_at)
  VALUES (NEW.id, NEW.email, NEW.created_at);
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- 3. 20251113054418_rls_policies.sql
-- å•Ÿç”¨ RLS + ä½¿ç”¨è€…è³‡æ–™éš”é›¢ç­–ç•¥
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Users can view own transactions"
  ON transactions FOR SELECT USING (auth.uid() = user_id);

-- 4. 20251113054900_indexes_functions.sql
-- æ•ˆèƒ½ç´¢å¼• + æ¥­å‹™é‚è¼¯è¼”åŠ©å‡½å¼
CREATE INDEX idx_transactions_user_date ON transactions(user_id, date DESC);
CREATE FUNCTION get_monthly_spending(...) RETURNS NUMERIC ...
```

### æœªä¾†è·¯å¾‘

å¦‚æœä¹‹å¾Œéœ€è¦åˆ‡æ›è‡³ Declarative Schemaï¼š

```bash
# å¾ç¾æœ‰é·ç§»ç”¢ç”Ÿ schema.sql
npx supabase db dump --schema public > supabase/schema.sql

# æœªä¾†è®Šæ›´ç·¨è¼¯ schema.sql ä¸¦åŸ·è¡Œ
npx supabase db diff
```

ç¾æœ‰çš„ Imperative migrations ä»ç„¶æœ‰æ•ˆä¸”å¯é‹ä½œã€‚

---

## ğŸ”— ADR 003: Design System é…ç½®

**æ—¥æœŸ**: 2025-11-05
**æ±ºç­–è€…**: é–‹ç™¼åœ˜éšŠ
**å®Œæ•´æ–‡æª”**: [ADR 003](../../decisions/design-system-configuration.md)

### æ±ºç­–æ‘˜è¦

æ¡ç”¨ **Hybrid æ¶æ§‹** + **Tailwind v4 CSS-first** + **shadcn/ui** å»ºç«‹è¨­è¨ˆç³»çµ±ã€‚

### æ ¸å¿ƒæ±ºç­–

#### 1. Component ä½ç½®ï¼šHybrid æ¶æ§‹

```
packages/ui/
â”œâ”€â”€ styles/
â”‚   â”œâ”€â”€ base-theme.css       # å…±äº« design tokens
â”‚   â””â”€â”€ themes/
â”‚       â”œâ”€â”€ lofi.css         # Apex ä¸»é¡Œï¼ˆé»‘ç™½æ¥µç°¡ï¼‰
â”‚       â””â”€â”€ corporate.css    # Flow ä¸»é¡Œï¼ˆå°ˆæ¥­è—ç¶ ï¼‰
â””â”€â”€ components/ui/           # shadcn components

apps/flow/components/        # Flow å°ˆå±¬ components
apps/apex/components/        # Apex å°ˆå±¬ components
```

**ç†ç”±**:

- åŸºç¤ themes å…±äº«ï¼Œç¢ºä¿è¨­è¨ˆä¸€è‡´æ€§
- App å¯ä»¥æœ‰å°ˆå±¬ components è™•ç†ç‰¹æ®Šéœ€æ±‚
- shadcn/ui components åœ¨ packages/uiï¼Œæ‰€æœ‰ app å…±ç”¨

#### 2. Tailwind é…ç½®ï¼šCSS-first (Tailwind v4)

```css
/* packages/ui/styles/base-theme.css */
@import 'tailwindcss';

@theme inline {
  --color-primary-500: oklch(0.5 0.2 150);
  --radius-lg: 0.5rem;
  /* å…±äº« design tokens */
}
```

**å„ªå‹¢**:

- âœ… Tailwind v4 å®˜æ–¹æ¨è–¦æ–¹å‘
- âœ… Runtime å‹•æ…‹ä¸»é¡Œï¼ˆCSS variablesï¼‰
- âœ… Hot reload ä¸éœ€é‡å•Ÿ
- âœ… Monorepo å‹å–„ï¼ˆç°¡å–®çš„ CSS importsï¼‰
- âœ… å®Œç¾ shadcn/ui ç›¸å®¹æ€§

#### 3. è‰²å½©ç³»çµ±ï¼šåˆ†é›¢ä¸»é¡Œ

**Flowï¼ˆè²¡å‹™è¿½è¹¤ï¼‰**: Corporate Theme

- å°ˆæ¥­è—ç¶ ç³»çµ±ï¼ˆdaisyUI Corporateï¼‰
- ç¶ è‰²å…ƒç´ ç”¨æ–¼è²¡å‹™æ­£å‘æŒ‡æ¨™

**Apexï¼ˆçµ±è¨ˆè¿½è¹¤ï¼‰**: Lofi Theme

- é»‘ç™½æ¥µç°¡ä¸»ç¾©ï¼ˆdaisyUI Lofiï¼‰
- é«˜å°æ¯”åº¦ï¼Œå°ˆæ³¨æ•¸æ“šå¯è¦–åŒ–

### å¯¦æ–½ç‹€æ…‹

- âœ… Flow: å·²ç§»é™¤ `tailwind.config.ts`ï¼Œä½¿ç”¨ CSS-first
- âœ… Apex: å¾ä¸€é–‹å§‹å°±ä½¿ç”¨ CSS-first
- âœ… ä¿ç•™ `postcss.config.mjs`ï¼ˆTailwind v4 å¿…éœ€ï¼‰
- âœ… Sprint 7, Task 1, 0.7.2, 0.7.3 å®Œæˆå¯¦ä½œ

---

## ğŸ“š ç›¸é—œæ–‡æª”

### æ¶æ§‹æ±ºç­–è¨˜éŒ„ (ADR)

- [ADR 001 - Architecture Simplification](../../decisions/001-architecture-simplification.md)
- [ADR 002 - Imperative Migrations](../../decisions/002-imperative-migrations.md)
- [ADR 003 - Design System Configuration](../../decisions/design-system-configuration.md)

### Sprint æ–‡æª”

- [Sprint 7 - Apex & Design System](../../sprints/release-0-foundation/07-overview.md)
- [Sprint 8 - Deployment Evaluation](../../sprints/release-0-foundation/08-deployment-evaluation.md)
- [Sprint 9 - Supabase Migration](../../sprints/release-0-foundation/09-supabase-migration-plan.md)

### æŠ€è¡“æŒ‡å—

- [æ¶æ§‹ç¸½è¦½](./overview.md)
- [æ¶æ§‹æ¯”è¼ƒ](./comparison.md)
- [é·ç§»æ–¹æ³•æŒ‡å—](../guides/migrations.md)
- [æœ¬åœ°é–‹ç™¼è¨­ç½®](../guides/local-development.md)

### å­˜æª”æ–‡æª”

- [NestJS API å¯¦ä½œ](../../archive/nestjs-api/)ï¼ˆåƒè€ƒç”¨ï¼‰
- [Render éƒ¨ç½²æŒ‡å—](../../archive/render-deployment/)ï¼ˆåƒè€ƒç”¨ï¼‰

---

## ğŸ”„ æ±ºç­–ç®¡ç†æµç¨‹

### å‰µå»ºæ–° ADR

ç•¶éœ€è¦åšå‡ºé‡è¦æ¶æ§‹æ±ºç­–æ™‚ï¼Œéµå¾ªä»¥ä¸‹æµç¨‹ï¼š

#### 1. è­˜åˆ¥éœ€è¦ ADR çš„æ±ºç­–

**éœ€è¦ ADR çš„æƒ…æ³**:

- å½±éŸ¿æ•´é«”æ¶æ§‹çš„æŠ€è¡“é¸å‹
- æ”¹è®Šé–‹ç™¼æˆ–éƒ¨ç½²æµç¨‹çš„æ±ºç­–
- å¼•å…¥æ–°çš„å·¥å…·æˆ–æ¡†æ¶
- ç§»é™¤æˆ–æ›¿æ›ç¾æœ‰æŠ€è¡“æ£§
- å½±éŸ¿æˆæœ¬æˆ–ç¶­è­·è² æ“”çš„æ±ºç­–

**ä¸éœ€è¦ ADR çš„æƒ…æ³**:

- å±€éƒ¨çš„å¯¦ä½œç´°ç¯€
- è‡¨æ™‚çš„è§£æ±ºæ–¹æ¡ˆ
- å¯è¼•æ˜“é€†è½‰çš„è®Šæ›´

#### 2. æ’°å¯« ADR æ–‡æª”

ä½¿ç”¨ä»¥ä¸‹ç¯„æœ¬ï¼š

```markdown
# ADR XXX: [æ±ºç­–æ¨™é¡Œ]

**ç‹€æ…‹**: [æè­°ä¸­ | å·²æ¥å— | å·²å»¢æ£„ | å·²å–ä»£]
**æ—¥æœŸ**: YYYY-MM-DD
**æ±ºç­–è€…**: [å§“å]
**ç›¸é—œæ–‡ä»¶**: [é€£çµ]

---

## èƒŒæ™¯è„ˆçµ¡

[æè¿°å•é¡Œã€éœ€æ±‚ã€ç•¶å‰ç‹€æ³]

---

## æ±ºç­–

[æ¸…æ¥šé™³è¿°æ±ºç­–å…§å®¹]

---

## ç†ç”±

[è©³ç´°èªªæ˜ç‚ºä½•åšå‡ºæ­¤æ±ºç­–]

---

## å½±éŸ¿

### æ­£é¢å½±éŸ¿

- [åˆ—é»]

### è² é¢å½±éŸ¿

- [åˆ—é»]

---

## è€ƒæ…®éçš„æ›¿ä»£æ–¹æ¡ˆ

### æ›¿ä»£æ–¹æ¡ˆ 1: [åç¨±]

**ç‚ºä½•æ‹’çµ•**: [åŸå› ]

---

## å¯¦ä½œ

[å¯¦æ–½è¨ˆåŠƒæˆ–å·²å®Œæˆçš„å¯¦ä½œ]

---

## é‡æ–°å¯©è¦–è§¸ç™¼æ¢ä»¶

[ä½•æ™‚éœ€è¦é‡æ–°è©•ä¼°æ­¤æ±ºç­–]

---

## ç›¸é—œæ±ºç­–

[å…¶ä»–ç›¸é—œçš„ ADR]
```

#### 3. å¯©æŸ¥èˆ‡æ‰¹å‡†

- è‡ªæˆ‘å¯©æŸ¥ï¼šç¢ºä¿é‚è¼¯æ¸…æ™°ã€ç†ç”±å……åˆ†
- æ–‡æª”å¯©æŸ¥ï¼šæª¢æŸ¥æ ¼å¼ã€é€£çµã€ç¯„ä¾‹
- å¯¦æ–½é©—è­‰ï¼šç¢ºä¿æ±ºç­–å¯åŸ·è¡Œ

#### 4. æ›´æ–°æ±ºç­–ç´¢å¼•

åœ¨æœ¬æ–‡æª”ï¼ˆdecisions.mdï¼‰ä¸­æ›´æ–°ï¼š

- æ±ºç­–ç´¢å¼•è¡¨
- æ±ºç­–æ™‚é–“è»¸
- ç›¸é—œç« ç¯€

### æ›´æ–°ç¾æœ‰ ADR

#### æ›´æ–°æµç¨‹

1. **è­˜åˆ¥éœ€è¦æ›´æ–°**ï¼š
   - æ±ºç­–åŸ·è¡Œå¾Œç™¼ç¾æ–°è³‡è¨Š
   - ç’°å¢ƒæˆ–éœ€æ±‚æ”¹è®Š
   - å¯¦æ–½çµæœèˆ‡é æœŸä¸ç¬¦

2. **æ›´æ–°æ–‡æª”**ï¼š
   - åœ¨ ADR æœ«å°¾æ·»åŠ ã€Œæ›´æ–°æ­·å²ã€ç« ç¯€
   - è¨˜éŒ„æ›´æ–°æ—¥æœŸå’ŒåŸå› 
   - ä¿ç•™åŸå§‹æ±ºç­–å…§å®¹

3. **ç‹€æ…‹è®Šæ›´**ï¼š
   - æè­°ä¸­ â†’ å·²æ¥å—ï¼ˆæ±ºç­–é€šéï¼‰
   - å·²æ¥å— â†’ å·²å»¢æ£„ï¼ˆæ±ºç­–å¤±æ•ˆï¼‰
   - å·²æ¥å— â†’ å·²å–ä»£ï¼ˆè¢«æ–° ADR å–ä»£ï¼‰

#### æ›´æ–°ç¯„ä¾‹

```markdown
---

## æ›´æ–°æ­·å²

### 2025-12-01 - å¯¦æ–½çµæœæ›´æ–°

**ç™¼ç¾**: Edge Functions åŸ·è¡Œæ•ˆèƒ½è¶…éé æœŸ
**å½±éŸ¿**: é™ä½äº†ã€Œéœ€è¦ NestJSã€çš„è§¸ç™¼é–¾å€¼
**è¡Œå‹•**: æ›´æ–°ã€Œé‡æ–°å¯©è¦–è§¸ç™¼æ¢ä»¶ã€ç« ç¯€
```

### å»¢æ£„ ADR

ç•¶æ±ºç­–ä¸å†é©ç”¨æ™‚ï¼š

1. **æ›´æ–° ADR ç‹€æ…‹**ç‚ºã€Œå·²å»¢æ£„ã€
2. **èªªæ˜å»¢æ£„åŸå› **
3. **é€£çµåˆ°æ›¿ä»£ ADR**ï¼ˆå¦‚æœæœ‰ï¼‰
4. **ä¿ç•™æ–‡æª”**ä½œç‚ºæ­·å²è¨˜éŒ„

```markdown
**ç‹€æ…‹**: âŒ å·²å»¢æ£„ - 2025-XX-XX
**å»¢æ£„åŸå› **: [èªªæ˜]
**å–ä»£æ–¹æ¡ˆ**: [é€£çµåˆ°æ–° ADR]
```

### ADR æœ€ä½³å¯¦è¸

#### æ’°å¯«åŸå‰‡

1. **æ¸…æ™°ç°¡æ½”**ï¼šé¿å…å†—é•·çš„æŠ€è¡“ç´°ç¯€ï¼Œå°ˆæ³¨æ±ºç­–é‚è¼¯
2. **æœ‰ç†æœ‰æ“š**ï¼šæ¯å€‹æ±ºç­–éƒ½è¦æœ‰å……åˆ†çš„ç†ç”±
3. **è€ƒæ…®æ›¿ä»£æ–¹æ¡ˆ**ï¼šå±•ç¤ºæ€è€ƒéç¨‹
4. **å¯è¿½æº¯**ï¼šé€£çµç›¸é—œæ–‡æª”å’Œæ±ºç­–
5. **å‰ç»æ€§**ï¼šè€ƒæ…®æœªä¾†çš„è®ŠåŒ–å’Œé·ç§»è·¯å¾‘

#### å¸¸è¦‹éŒ¯èª¤

âŒ **éŒ¯èª¤ 1**ï¼šéæ–¼æŠ€è¡“æ€§ï¼Œç¼ºä¹æ¥­å‹™è„ˆçµ¡

```markdown
# éŒ¯èª¤ç¤ºç¯„

æ±ºç­–ï¼šä½¿ç”¨ PostgreSQL JSONB æ¬„ä½å„²å­˜å…ƒè³‡æ–™
ç†ç”±ï¼šJSONB æ”¯æ´ç´¢å¼•
```

âœ… **æ­£ç¢ºåšæ³•**ï¼š

```markdown
æ±ºç­–ï¼šä½¿ç”¨ PostgreSQL JSONB æ¬„ä½å„²å­˜äº¤æ˜“å…ƒè³‡æ–™
ç†ç”±ï¼š

- äº¤æ˜“å…ƒè³‡æ–™çµæ§‹ä¸å›ºå®šï¼ˆä¸åŒé¡åˆ¥æœ‰ä¸åŒæ¬„ä½ï¼‰
- JSONB æ”¯æ´ç´¢å¼•ï¼Œæ•ˆèƒ½ä¸å—å½±éŸ¿
- é¿å…å»ºç«‹å¤šå€‹ç¨€ç–çš„æ¬„ä½
- ä¿æŒ schema ç°¡æ½”
```

âŒ **éŒ¯èª¤ 2**ï¼šç¼ºä¹æ›¿ä»£æ–¹æ¡ˆåˆ†æ

```markdown
# éŒ¯èª¤ç¤ºç¯„

æ±ºç­–ï¼šä½¿ç”¨ Supabase
ç†ç”±ï¼šSupabase å¾ˆå¥½ç”¨
```

âœ… **æ­£ç¢ºåšæ³•**ï¼š

```markdown
æ±ºç­–ï¼šä½¿ç”¨ Supabase
ç†ç”±ï¼š

- å®Œç¾é©åˆ Flourish CRUD éœ€æ±‚
- æˆæœ¬ï¼š$0 vs NestJS $7/æœˆ
- é–‹ç™¼æ•ˆç‡ï¼šå¿« 75%
- ç¶­è­·ï¼šæ¸›å°‘ 70% å·¥ä½œé‡

è€ƒæ…®éçš„æ›¿ä»£æ–¹æ¡ˆï¼š

- NestJS + Renderï¼šéåº¦è¨­è¨ˆï¼Œæˆæœ¬é«˜
- Firebaseï¼šNoSQL ä¸é©åˆé—œè¯å¼è³‡æ–™
- AWS Amplifyï¼šå­¸ç¿’æ›²ç·šé™¡å³­
```

âŒ **éŒ¯èª¤ 3**ï¼šå¿½ç•¥æœªä¾†è®ŠåŒ–

```markdown
# éŒ¯èª¤ç¤ºç¯„

æ±ºç­–ï¼šä½¿ç”¨ Supabase
ç†ç”±ï¼šå®Œç¾é©åˆç•¶å‰éœ€æ±‚
```

âœ… **æ­£ç¢ºåšæ³•**ï¼š

```markdown
æ±ºç­–ï¼šä½¿ç”¨ Supabase
ç†ç”±ï¼šå®Œç¾é©åˆç•¶å‰éœ€æ±‚

é‡æ–°å¯©è¦–è§¸ç™¼æ¢ä»¶ï¼š

- ä½¿ç”¨è€…é‡ > 50K MAU
- éœ€è¦è¤‡é›œæ¥­å‹™é‚è¼¯
- éœ€è¦å¤§é‡ç¬¬ä¸‰æ–¹æ•´åˆ

é·ç§»è·¯å¾‘ï¼š

- å‡ç´š Supabase æ–¹æ¡ˆ
- æ·»åŠ  Edge Functions
- å›åˆ° NestJSï¼ˆæ–‡æª”å·²å­˜æª”ï¼‰
```

---

## ğŸ“ æ±ºç­–åˆ†ææ¡†æ¶

### SWOT åˆ†æç¯„æœ¬

åœ¨è©•ä¼°æ–°çš„æ¶æ§‹æ±ºç­–æ™‚ï¼Œä½¿ç”¨ SWOT åˆ†æï¼š

```markdown
## SWOT åˆ†æ

### Strengthsï¼ˆå„ªå‹¢ï¼‰

- [å…§éƒ¨æ­£é¢å› ç´ ]

### Weaknessesï¼ˆåŠ£å‹¢ï¼‰

- [å…§éƒ¨è² é¢å› ç´ ]

### Opportunitiesï¼ˆæ©Ÿæœƒï¼‰

- [å¤–éƒ¨æ­£é¢å› ç´ ]

### Threatsï¼ˆå¨è„…ï¼‰

- [å¤–éƒ¨è² é¢å› ç´ ]
```

### æ±ºç­–è©•åˆ†çŸ©é™£

ä½¿ç”¨è©•åˆ†çŸ©é™£é‡åŒ–æ¯”è¼ƒï¼š

| è©•ä¼°é¢å‘     | æ¬Šé‡ | æ–¹æ¡ˆ A   | æ–¹æ¡ˆ B   | æ–¹æ¡ˆ C   |
| ------------ | ---- | -------- | -------- | -------- |
| æˆæœ¬         | 30%  | 9/10     | 5/10     | 7/10     |
| é–‹ç™¼æ•ˆç‡     | 25%  | 8/10     | 6/10     | 7/10     |
| ç¶­è­·         | 20%  | 9/10     | 5/10     | 6/10     |
| å­¸ç¿’æ›²ç·š     | 15%  | 7/10     | 4/10     | 8/10     |
| æ“´å±•æ€§       | 10%  | 8/10     | 9/10     | 7/10     |
| **åŠ æ¬Šç¸½åˆ†** | 100% | **8.25** | **5.45** | **7.00** |

---

## ğŸ“‹ æ±ºç­–æª¢æŸ¥æ¸…å–®

### æ–°æ¶æ§‹æ±ºç­–æª¢æŸ¥æ¸…å–®

åœ¨åšå‡ºé‡è¦æ¶æ§‹æ±ºç­–å‰ï¼Œç¢ºä¿å›ç­”ä»¥ä¸‹å•é¡Œï¼š

#### å•é¡Œåˆ†æ

- [ ] å•é¡Œå®šç¾©æ¸…æ¥šå—ï¼Ÿ
- [ ] ç•¶å‰æ–¹æ¡ˆçš„ç—›é»æ˜¯ä»€éº¼ï¼Ÿ
- [ ] ä¸æ”¹è®Šçš„æˆæœ¬æ˜¯ä»€éº¼ï¼Ÿ

#### æ–¹æ¡ˆè©•ä¼°

- [ ] è‡³å°‘è©•ä¼°äº† 3 å€‹æ›¿ä»£æ–¹æ¡ˆï¼Ÿ
- [ ] è€ƒæ…®äº†æˆæœ¬ã€æ™‚é–“ã€å“è³ªçš„æ¬Šè¡¡ï¼Ÿ
- [ ] æ–¹æ¡ˆç¬¦åˆå°ˆæ¡ˆè¦æ¨¡å’Œåœ˜éšŠèƒ½åŠ›ï¼Ÿ

#### é¢¨éšªç®¡ç†

- [ ] è­˜åˆ¥äº†ä¸»è¦é¢¨éšªï¼Ÿ
- [ ] æ¯å€‹é¢¨éšªéƒ½æœ‰ç·©è§£ç­–ç•¥ï¼Ÿ
- [ ] æœ‰å‚™æ´è¨ˆåŠƒï¼ˆPlan Bï¼‰ï¼Ÿ

#### æœªä¾†è€ƒé‡

- [ ] è€ƒæ…®äº†æœªä¾† 6-12 å€‹æœˆçš„éœ€æ±‚ï¼Ÿ
- [ ] å®šç¾©äº†é‡æ–°è©•ä¼°çš„è§¸ç™¼æ¢ä»¶ï¼Ÿ
- [ ] è¦åŠƒäº†é·ç§»è·¯å¾‘ï¼ˆå¦‚éœ€è¦ï¼‰ï¼Ÿ

#### æ–‡æª”

- [ ] æ’°å¯«äº†å®Œæ•´çš„ ADRï¼Ÿ
- [ ] æ›´æ–°äº†ç›¸é—œæ–‡æª”ï¼Ÿ
- [ ] æä¾›äº†å¯¦ä½œæŒ‡å—ï¼Ÿ

---

**æœ€å¾Œæ›´æ–°**: 2025-11-24
**ç‹€æ…‹**: âœ… å·²å®Œæˆï¼ˆTask 3ï¼‰
**ç¶­è­·è€…**: Henry Lee
